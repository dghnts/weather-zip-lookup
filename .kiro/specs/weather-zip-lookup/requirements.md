# 要件ドキュメント

## はじめに

本ドキュメントは、郵便番号に基づいて天気情報を取得するクロスプラットフォーム対応のターミナルスクリプトの要件を定義します。本システムは、Mac OS、Windows、Linuxの各環境で動作し、現在の気温と降水確率を視覚的にフォーマットされた形式でユーザーに提供します。

## 用語集

- **Weather_Script**: 天気情報を取得して表示するターミナルアプリケーション
- **Weather_API**: 天気データを取得するために使用する外部のOpenWeatherMap APIサービス
- **Config_File**: デフォルトの郵便番号を含むユーザー設定を保存するローカルファイル
- **Postal_Code**: 地理的な場所を識別する数値コード（日本の郵便番号形式：7桁）
- **Temperature**: 摂氏で測定された現在の気温
- **Precipitation_Probability**: パーセンテージで表現された降水の可能性
- **Weather_Alert**: 特定の地域に対する気象警報または注意報（熱波、寒波、強風、雪、濃霧、大雨、雷など）

## 要件

### 要件1: 天気データ取得

**ユーザーストーリー:** ユーザーとして、特定の郵便番号の現在の天気情報を取得したい。そうすることで、その場所の気温と降水確率を素早く確認できる。

#### 受け入れ基準

1. WHEN 有効な郵便番号が提供される THEN Weather_ScriptはWeather_APIから摂氏での現在の気温を取得するものとする
2. WHEN 有効な郵便番号が提供される THEN Weather_ScriptはWeather_APIからパーセンテージでの降水確率を取得するものとする
3. WHEN Weather_APIがデータを返す THEN Weather_Scriptはレスポンスを解析し、気温と降水確率の値を抽出するものとする
4. IF Weather_APIリクエストが失敗する THEN Weather_Scriptはユーザーに説明的なエラーメッセージを表示するものとする
5. IF 無効な郵便番号形式が提供される THEN Weather_Scriptは検証エラーメッセージを表示するものとする

### 要件2: コマンドラインインターフェース

**ユーザーストーリー:** ユーザーとして、コマンドライン引数で郵便番号を指定したい。そうすることで、設定を変更せずに異なる場所の天気を素早く確認できる。

#### 受け入れ基準

1. WHEN ユーザーがコマンドライン引数として郵便番号を提供する THEN Weather_Scriptはその郵便番号を天気クエリに使用するものとする
2. WHEN コマンドライン引数が提供されない THEN Weather_ScriptはConfig_Fileからデフォルトの郵便番号を使用するものとする
3. THE Weather_Scriptは7桁の日本の郵便番号形式で郵便番号を受け入れるものとする
4. WHEN ユーザーがヘルプフラグを提供する THEN Weather_Scriptは使用方法の説明を表示するものとする

### 要件3: 設定管理

**ユーザーストーリー:** ユーザーとして、デフォルトの郵便番号を設定ファイルに保存したい。そうすることで、天気を確認するたびに入力する必要がなくなる。

#### 受け入れ基準

1. WHEN Weather_Scriptが初回実行される THEN Weather_ScriptはユーザーのホームディレクトリにConfig_Fileを作成するものとする
2. THE Weather_Scriptはコマンドライン引数が提供されない場合、Config_Fileからデフォルトの郵便番号を読み取るものとする
3. WHEN Config_Fileが存在しないか破損している THEN Weather_Scriptはユーザーに郵便番号の提供を促すものとする
4. THE Weather_Scriptは各オペレーティングシステムに適したプラットフォーム固有の場所に設定を保存するものとする
5. THE Weather_ScriptはユーザーがConfig_File内のデフォルト郵便番号を更新できるようにするものとする

### 要件4: クロスプラットフォーム互換性

**ユーザーストーリー:** 任意のオペレーティングシステムのユーザーとして、スクリプトが一貫して動作することを望む。そうすることで、プラットフォームに関係なく同じツールを使用できる。

#### 受け入れ基準

1. THE Weather_ScriptはMac OSシステムで正常に実行されるものとする
2. THE Weather_ScriptはWindowsシステムで正常に実行されるものとする
3. THE Weather_ScriptはLinuxシステムで正常に実行されるものとする
4. THE Weather_ScriptはConfig_Fileに対してプラットフォーム非依存のファイルパス処理を使用するものとする
5. THE Weather_Scriptはすべてのプラットフォームで一貫して文字エンコーディングを処理するものとする

### 要件5: 出力フォーマット

**ユーザーストーリー:** ユーザーとして、天気情報を視覚的に明確でフォーマットされた方法で見たい。そうすることで、現在の状況を素早く理解できる。

#### 受け入れ基準

1. WHEN 天気データが表示される THEN Weather_Scriptは色分けされた出力をフォーマットするものとする
2. WHEN 天気データが表示される THEN Weather_Scriptはクエリされている郵便番号を表示するものとする
3. WHEN 天気データが表示される THEN Weather_Scriptは摂氏単位記号付きで気温を表示するものとする
4. WHEN 天気データが表示される THEN Weather_Scriptはパーセンテージ記号付きで降水確率を表示するものとする
5. WHEN 天気データが表示される THEN Weather_Scriptは視覚的な区切りやフォーマットを使用して可読性を向上させるものとする

### 要件6: API統合

**ユーザーストーリー:** ユーザーとして、スクリプトが信頼性の高い無料の天気APIを使用することを望む。そうすることで、サブスクリプション費用なしで天気データにアクセスできる。

#### 受け入れ基準

1. THE Weather_ScriptはOpenWeatherMap APIを天気データソースとして使用するものとする
2. THE Weather_ScriptはAPIキーをConfig_Fileに保存するものとする
3. WHEN APIキーが欠落している THEN Weather_Scriptはユーザーに提供を促すものとする
4. THE Weather_ScriptはWeather_APIへのリクエストにAPIキーを含めるものとする
5. WHEN APIレート制限を超える THEN Weather_Scriptは適切なエラーメッセージを表示するものとする

### 要件7: エラーハンドリング

**ユーザーストーリー:** ユーザーとして、何か問題が発生したときに明確なエラーメッセージを受け取りたい。そうすることで、問題を素早く理解して解決できる。

#### 受け入れ基準

1. IF ネットワーク接続が失敗する THEN Weather_Scriptはネットワークエラーメッセージを表示するものとする
2. IF Weather_APIがエラーレスポンスを返す THEN Weather_Scriptはエラーの詳細を表示するものとする
3. IF 郵便番号がWeather_APIで見つからない THEN Weather_Scriptはユーザーに場所が見つからなかったことを通知するものとする
4. IF Config_Fileが読み取りまたは書き込みできない THEN Weather_Scriptはファイルアクセスエラーメッセージを表示するものとする
5. THE Weather_Scriptは異なる失敗シナリオに対して適切なエラーコードで終了するものとする

### 要件8: 気象警報表示

**ユーザーストーリー:** ユーザーとして、自分のエリアに気象警報がある場合、その詳細を確認したい。そうすることで、危険な気象条件に備えることができる。

#### 受け入れ基準

1. WHEN Weather_APIが気象警報データを返す THEN Weather_Scriptはすべてのアクティブな警報を取得するものとする
2. WHEN 気象警報が存在する THEN Weather_Scriptは警報の種類（熱波、寒波、強風、雪、濃霧、大雨、雷）を表示するものとする
3. WHEN 気象警報が存在する THEN Weather_Scriptは警報の説明を表示するものとする
4. WHEN 気象警報が表示される THEN Weather_Scriptは特別な色やアイコンを使用して警報を目立たせるものとする
5. WHEN 気象警報が存在しない THEN Weather_Scriptは警報に関する情報を表示しないものとする
